// Get the necessary size of the buffer.
dwRetVal = GetAdaptersInfo(pAdapterInfo, &ulOutBufLen);

if (dwRetVal == ERROR_BUFFER_OVERFLOW)
{
    pAdapterInfo = (IP_ADAPTER_INFO *)malloc(ulOutBufLen);

    if (pAdapterInfo == NULL)
    {
        return 1;
    }
}

// Get the adapter information.
dwRetVal = GetAdaptersInfo(pAdapterInfo, &ulOutBufLen);

if (dwRetVal == NO_ERROR)
{
    pAdapter = pAdapterInfo;

    while (pAdapter)
    {
        sprintf(szTemp, "%d.%d.%d.%d", pAdapter->IpAddressList.IpAddress.String[0], pAdapter->IpAddressList.IpAddress.String[1], pAdapter->IpAddressList.IpAddress.String[2], pAdapter->IpAddressList.IpAddress.String[3]);

        ofstream fout("FlipperZeroIPAddresses.txt", ios::out | ios::app);
        if (fout.is_open())
        {
            fout << szTemp << endl;
        }
        fout.close();

        pAdapter = pAdapter->Next;
    }
}

if (pAdapterInfo)
{
    free(pAdapterInfo);
}

return 0;
